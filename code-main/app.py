from flask import Flask, render_template
import plotly.express as px
import plotly
import pandas as pd
import json

#archivo = open("/datos/ventas_MARO.csv", "r")

app = Flask(__name__)

@app.route('/')
def bar_with_plotly():
    students = [['2025-01-01', 176.1179920013427, 171.05372440840546, 180.99884924508333],
                ['2025-02-01', 164.8596871980668, 159.82263410394967, 169.53730033192957],
                ['2025-03-01', 173.13917457153678, 168.16805939496024, 177.9666213975889],
                ['2025-04-01', 174.2671240574711, 169.15053011037762, 178.9280244687248],
                ['2025-05-01', 174.3590443349338, 169.6865440674844, 179.10883978302505],
                ['2025-06-01', 175.51510226579882, 170.30637791699087, 180.106927964329],
                ['2025-07-01', 177.3152863038619, 172.37591338945185,182.23771252299971],
                ['2025-08-01', 177.71004028412221, 173.11667012696887,182.6730041484535],
                ['2025-09-01', 175.60530595587835, 170.55593589105402,180.24951207723873],
                ['2025-10-01', 179.157283461132, 174.45730984244034,184.14344606743865],
                ['2025-11-01', 173.80176320223666, 168.7619316670226,178.96460681428567],
                ['2025-12-01', 180.52740211445825, 175.11265225953363,185.34675603813795],
                ]
    
    df = pd.DataFrame(students,
                      columns=['Fecha','Promedio','Minimo','Country'],
                      index=['a','b','c','d','e','f','g','h','i','j','k','l'])
    
    fig = px.bar(df, x='Fecha', y='Promedio', color='Minimo', barmode='group')
    graphJSON = json.dumps(fig, cls=plotly.utils.PlotlyJSONEncoder)
    
    return render_template('index.html', graphJSON=graphJSON)

if __name__ == '__main__':
    app.run(debug=True)